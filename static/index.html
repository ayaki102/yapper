<!DOCTYPE html>
<html lang="pl">
<meta name="viewport" content="width=device-width, initial-scale=1">

<body style="margin:0;padding:0;font-family:sans-serif;background:#111;color:#fff;display:flex;flex-direction:column;height:100vh">

<!-- Chat window -->
<div id="chat" style="flex:1;overflow-y:auto;padding:1rem;display:flex;flex-direction:column;gap:0.5rem;"></div>

<!-- Input area -->
<div style="display:flex;gap:0.5rem;padding:0.5rem;background:#222;">
  <textarea id="t" style="flex:1;height:3rem;font-size:1rem;padding:0.5rem;border-radius:8px;background:#111;color:#fff;resize:none"></textarea>
  <button onclick="send()" style="padding:0 1rem;font-size:1rem;border-radius:8px;background:#0f0;color:#111;font-weight:bold;">WYÅšLIJ</button>
</div>

<script>
const SERVER = window.location.origin

function addMessage(text, from="pc") {
    const chat = document.getElementById("chat")
    const msg = document.createElement("div")
    msg.textContent = text
    msg.style.padding = "0.5rem 1rem"
    msg.style.borderRadius = "12px"
    msg.style.maxWidth = "80%"
    msg.style.wordBreak = "break-word"
    msg.style.alignSelf = from === "phone" ? "flex-end" : "flex-start"
    msg.style.backgroundColor = from === "phone" ? "#0f0" : "#222"
    msg.style.color = from === "phone" ? "#111" : "#0f0"
    chat.appendChild(msg)
    chat.scrollTop = chat.scrollHeight
}

async function send() {
    const t = document.getElementById("t")
    const text = t.value.trim()
    if (!text) return
    addMessage(text, "phone")
    await fetch(`${SERVER}/send_tts`, {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body: JSON.stringify({text})
    })
    t.value = ""
}

setInterval(async () => {
    const r = await fetch(`${SERVER}/get_stt`)
    const j = await r.json()
    if (j.text) addMessage(j.text, "pc")
}, 1000)
</script>

</body>
</html>

